<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navjyot Singh | Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #0a0a0a;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        .gradient-text {
            background: linear-gradient(90deg, #8A2BE2, #4B0082, #00FFFF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .card {
            background-color: rgba(26, 26, 26, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }
        .card:hover {
            border-color: #00FFFF;
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }
        .skill-tag {
            background-color: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            color: #00FFFF;
            transition: all 0.3s ease;
        }
        .skill-tag:hover {
            background-color: rgba(0, 255, 255, 0.3);
            transform: scale(1.1);
        }
        .scroll-animation {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .scroll-animation.animate {
            opacity: 1;
            transform: translateY(0);
        }
        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .glow-button {
            background: linear-gradient(90deg, #8A2BE2, #4B0082);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
            cursor: pointer;
        }
        .glow-button:hover {
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.8);
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(8px);
        }
        .rating-star {
            color: #444;
            cursor: pointer;
            transition: color 0.2s, transform 0.2s;
        }
        .rating-star:hover, .rating-star.hovered {
            color: #FFD700;
            transform: scale(1.2);
        }
        .rating-star.selected {
             color: #FFD700;
        }
    </style>
</head>
<body class="antialiased">
    <canvas id="particle-canvas"></canvas>

    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <header class="py-8 flex justify-between items-center fixed top-0 left-0 right-0 z-10 container mx-auto px-4 sm:px-6 lg:px-8 bg-[#0a0a0a]/80 backdrop-blur-sm">
            <h1 class="text-2xl font-bold gradient-text">NS.</h1>
            <nav class="hidden md:flex space-x-8">
                <a href="#about" class="hover:text-[#00FFFF] transition duration-300">About</a>
                <a href="#skills" class="hover:text-[#00FFFF] transition duration-300">Skills</a>
                <a href="#projects" class="hover:text-[#00FFFF] transition duration-300">Projects</a>
                <a href="#education" class="hover:text-[#00FFFF] transition duration-300">Education</a>
                <a href="#contact" class="hover:text-[#00FFFF] transition duration-300">Contact</a>
            </nav>
        </header>

        <section id="hero" class="min-h-screen flex items-center text-center md:text-left pt-20">
            <div class="max-w-4xl mx-auto md:mx-0">
                 <p id="name-container" class="text-lg md:text-xl text-gray-400 mb-4 cursor-pointer font-mono" title="Rate to decrypt">N***********h</p>
                <h2 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-4 leading-tight">
                    <span id="typing-text"></span>
                </h2>
                <p class="text-lg md:text-xl text-gray-400 mb-8 max-w-2xl">
                    Bridging the gap between hardware architecture and software logic to build intelligent, automated systems.
                </p>
                <a href="#projects" class="glow-button text-white font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 inline-block">
                    View My Work
                </a>
            </div>
        </section>

        <section id="about" class="py-20 scroll-animation">
            <h3 class="text-3xl font-bold mb-12 text-center gradient-text scramble-text">About Me</h3>
            <div class="card p-8 md:p-12 rounded-2xl max-w-4xl mx-auto" data-tilt data-tilt-max="5" data-tilt-speed="400" data-tilt-perspective="1000">
                <p class="text-lg leading-relaxed text-gray-300">
                    Hello! I'm <strong>Navjyot Singh</strong>, a first-year B.Tech student in Electronics & Telecommunications at Bharati Vidyapeeth College of Engineering, Pune. 
                    <br><br>
                    I am deeply interested in <strong>Embedded Systems</strong> and the intersection of hardware and software. My passion lies in understanding industrial manufacturing operations and leveraging AI tools to accelerate development. Whether it's rapid prototyping with Arduino or exploring Machine Learning algorithms for automation, I am committed to engineering efficient solutions. I am currently seeking an entry-level internship to apply my skills in a professional environment.
                </p>
            </div>
        </section>

        <section id="skills" class="py-20 scroll-animation">
            <h3 class="text-3xl font-bold mb-12 text-center gradient-text scramble-text">Technical Arsenal</h3>
            <div class="max-w-5xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">C / C++</h4><p class="text-gray-400">Firmware & Logic</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">Arduino</h4><p class="text-gray-400">Embedded Systems</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">Git & GitHub</h4><p class="text-gray-400">Version Control</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">Python</h4><p class="text-gray-400">AI & Scripting</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">Digital Logic</h4><p class="text-gray-400">Gates & Flip-Flops</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">Sensors</h4><p class="text-gray-400">Integration & Calibration</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">IoT</h4><p class="text-gray-400">Foundations</p></div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000"><h4 class="text-xl font-semibold mb-2">AI Tools</h4><p class="text-gray-400">Rapid Prototyping</p></div>
            </div>
        </section>

        <section id="projects" class="py-20 scroll-animation">
            <h3 class="text-3xl font-bold mb-12 text-center gradient-text scramble-text">Featured Projects</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="card rounded-2xl overflow-hidden group" data-tilt data-tilt-max="5" data-tilt-speed="400" data-tilt-perspective="1000">
                    <div class="p-6">
                        <h4 class="text-2xl font-bold mb-2 text-white">Auto Plant Watering</h4>
                        <p class="text-gray-400 mb-4">A fully automated irrigation system using Arduino Uno. Implemented hysteresis-based threshold logic to prevent chattering and interrupt-driven logic (ISRs) for power optimization.</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                           <span class="skill-tag text-sm font-medium px-3 py-1 rounded-full">Arduino</span>
                           <span class="skill-tag text-sm font-medium px-3 py-1 rounded-full">C++</span>
                           <span class="skill-tag text-sm font-medium px-3 py-1 rounded-full">Sensors</span>
                        </div>
                        <a href="https://github.com/N2V5Y7T/automatic-watering-system/tree/main" target="_blank" class="text-[#00FFFF] hover:underline">View on GitHub &rarr;</a>
                    </div>
                </div>
                 <div class="card rounded-2xl overflow-hidden group" data-tilt data-tilt-max="5" data-tilt-speed="400" data-tilt-perspective="1000">
                     <div class="p-6">
                        <h4 class="text-2xl font-bold mb-2 text-white">AI & ML Study</h4>
                        <p class="text-gray-400 mb-4">An independent study exploring the fundamentals of Machine Learning algorithms with a focus on applications in predictive maintenance and automation systems.</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                           <span class="skill-tag text-sm font-medium px-3 py-1 rounded-full">Python</span>
                           <span class="skill-tag text-sm font-medium px-3 py-1 rounded-full">ML Algorithms</span>
                           <span class="skill-tag text-sm font-medium px-3 py-1 rounded-full">Automation</span>
                        </div>
                        <span class="text-gray-500 text-sm">Self-Paced Research</span>
                    </div>
                </div>
                 <div class="card rounded-2xl overflow-hidden group border-dashed border-2 border-[#00FFFF]/30" data-tilt data-tilt-max="5" data-tilt-speed="400" data-tilt-perspective="1000">
                     <div class="p-6 flex flex-col h-full justify-between">
                        <div>
                            <h4 class="text-2xl font-bold mb-2 text-white">Next: Your Project?</h4>
                            <p class="text-gray-400 mb-4">I am actively seeking an internship to apply my skills in Embedded Systems and AI. Let's solve your engineering challenges together.</p>
                        </div>
                        <div class="mt-4">
                           <a href="#contact" class="glow-button text-white text-sm font-bold py-2 px-6 rounded-full inline-block">Hire Me</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="education" class="py-20 scroll-animation">
            <h3 class="text-3xl font-bold mb-12 text-center gradient-text scramble-text">Education</h3>
            <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-8">
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000">
                    <h4 class="text-xl font-semibold mb-2">B.Tech (ENTC)</h4>
                    <p class="text-[#00FFFF] mb-1">Bharati Vidyapeeth College of Engineering</p>
                    <p class="text-gray-400">Pune | Expected 2029</p>
                    <p class="text-sm text-gray-500 mt-2">Specializing in Electronics & Telecommunications</p>
                </div>
                <div class="card p-6 rounded-lg text-center" data-tilt data-tilt-max="8" data-tilt-speed="400" data-tilt-perspective="1000">
                    <h4 class="text-xl font-semibold mb-2">HSC (12th Grade)</h4>
                    <p class="text-[#00FFFF] mb-1">Dr. Kalmadi Shamarao Junior College</p>
                    <p class="text-gray-400">Science Stream (PCM)</p>
                    <p class="text-sm text-gray-500 mt-2">Bifocal Electronics | Analog & Digital Circuits</p>
                </div>
            </div>
        </section>

        <section id="contact" class="py-20 text-center scroll-animation">
             <h3 class="text-3xl font-bold mb-4 gradient-text scramble-text">Let's Connect</h3>
             <p class="text-lg text-gray-400 mb-8 max-w-2xl mx-auto">I'm currently open to new opportunities, especially in Embedded Systems and IoT. Feel free to reach out!</p>
             <div id="contact-container">
                <button id="contact-button" class="glow-button text-white font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 inline-block">
                    Say Hello
                </button>
             </div>
        </section>

        <footer class="text-center py-8 border-t border-gray-800">
            <div class="flex justify-center space-x-6 mb-4">
                <a href="https://github.com/N2V5Y7T" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors duration-300" title="GitHub">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.168 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.378.203 2.398.1 2.651.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z" clip-rule="evenodd" />
                    </svg>
                </a>
                <a href="https://www.linkedin.com/in/N2V5Y7T" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors duration-300" title="LinkedIn">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                    </svg>
                </a>
            </div>
            <p class="text-gray-500">&copy; 2025 Navjyot Singh. All rights reserved.</p>
        </footer>
    </div>

    <div id="rating-modal" class="modal-overlay hidden">
        <div class="card p-8 rounded-2xl max-w-sm mx-auto text-center">
            <h3 class="text-2xl font-bold mb-2 gradient-text">Decrypt Profile?</h3>
            <p class="text-gray-400 mb-6">Rate this portfolio (any star) to verify you are human and unlock my contact details.</p>
            <div id="rating-stars" class="flex justify-center text-4xl mb-6">
                <span class="rating-star" data-value="1">★</span>
                <span class="rating-star" data-value="2">★</span>
                <span class="rating-star" data-value="3">★</span>
                <span class="rating-star" data-value="4">★</span>
                <span class="rating-star" data-value="5">★</span>
            </div>
            <div id="modal-feedback" class="h-6 text-sm text-[#00FFFF] mb-2 opacity-0 transition-opacity"></div>
            <button id="close-modal" class="text-sm text-gray-500 hover:text-white">Maybe later</button>
        </div>
    </div>
    
    <script type="text/javascript" src="https://unpkg.com/vanilla-tilt@1.7.0/dist/vanilla-tilt.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- REVEAL & EMAIL LOGIC ---
            const realName = "Navjyot Singh";
            const realEmail = "gundev.navjyot.singh@gmail.com";
            let detailsRevealed = false;
            let nameScrambleInterval; 
            const scrambleChars = ['*', '#', '$', '%', '&', '@', '!', '?'];

            const nameContainer = document.getElementById('name-container');
            const contactContainer = document.getElementById('contact-container');
            const contactButton = document.getElementById('contact-button');
            const modal = document.getElementById('rating-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const stars = document.querySelectorAll('.rating-star');
            const feedback = document.getElementById('modal-feedback');

            // CONTINUOUS SCRAMBLE (ENCRYPTION EFFECT)
            function startNameScramble() {
                if (detailsRevealed) return;
                nameScrambleInterval = setInterval(() => {
                    let scrambledText = realName[0];
                    for (let i = 1; i < realName.length - 1; i++) {
                        if (realName[i] === ' ') {
                           scrambledText += ' ';
                        } else {
                           scrambledText += scrambleChars[Math.floor(Math.random() * scrambleChars.length)];
                        }
                    }
                    scrambledText += realName[realName.length - 1];
                    nameContainer.textContent = scrambledText;
                }, 80);
            }

            // GMAIL REDIRECT LOGIC
            function openGmail() {
                const subject = "Enquiry: Portfolio Opportunity";
                const body = "Hi Navjyot,\n\nI was impressed by your portfolio and would like to discuss a potential collaboration.\n\nBest regards,";
                // Generates a direct link to Gmail Web Compose
                const gmailLink = `https://mail.google.com/mail/?view=cm&fs=1&to=${realEmail}&su=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.open(gmailLink, '_blank');
            }

            function openModal() {
                if (!detailsRevealed) {
                    modal.classList.remove('hidden');
                } else {
                    // IF REVEALED: EXECUTE GMAIL REDIRECT
                    openGmail();
                }
            }

            function closeModal() {
                modal.classList.add('hidden');
                stars.forEach(s => s.classList.remove('selected')); 
                feedback.style.opacity = '0';
            }

            // UNLOCK FUNCTION
            function revealDetails() {
                clearInterval(nameScrambleInterval); 
                
                // 1. Reveal Name
                nameContainer.textContent = realName;
                nameContainer.classList.remove('cursor-pointer');
                nameContainer.title = "Profile Decrypted";

                // 2. Update Contact Button to Open Email
                contactButton.textContent = "Email Me";
                // Directly bind click to openGmail for subsequent clicks
                contactButton.onclick = openGmail;
                
                detailsRevealed = true;
                
                // Close modal after a brief success delay
                feedback.textContent = "Thank you! Access Granted.";
                feedback.style.opacity = '1';
                
                setTimeout(() => {
                    closeModal();
                }, 800);
            }

            // Event Listeners
            nameContainer.addEventListener('click', openModal);
            contactButton.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });

            // Star Logic
            stars.forEach(star => {
                star.addEventListener('mouseover', () => {
                    const value = star.dataset.value;
                    stars.forEach(s => {
                        s.classList.toggle('hovered', s.dataset.value <= value);
                    });
                });

                star.addEventListener('mouseout', () => {
                    stars.forEach(s => s.classList.remove('hovered'));
                });

                star.addEventListener('click', () => {
                    const value = star.dataset.value;
                    
                    // Highlights selected stars
                    stars.forEach(s => {
                        s.classList.toggle('selected', s.dataset.value <= value);
                    });

                    // LOGIC: ANY RATING UNLOCKS THE PROFILE
                    revealDetails();
                });
            });

            // Start the encryption effect immediately
            startNameScramble();

            // --- FIXED TYPING ANIMATION ---
            new Typed('#typing-text', {
                strings: [
                    '<span class="gradient-text">Embedded Systems</span>', 
                    '<span class="gradient-text">B.Tech Student (ENTC)</span>', 
                    '<span class="gradient-text">AI & ML Learner</span>'
                ],
                typeSpeed: 50,
                backSpeed: 50,
                backDelay: 1000,
                loop: true,
                smartBackspace: false,
                contentType: 'html'
            });

            // --- 3D TILT ---
            VanillaTilt.init(document.querySelectorAll(".card"), {
                max: 15,
                speed: 400,
                glare: true,
                "max-glare": 0.2
            });

            // --- PARTICLES ---
            const canvas = document.getElementById('particle-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            let particlesArray;
            const mouse = { x: null, y: null, radius: (canvas.height / 120) * (canvas.width / 120) }
            window.addEventListener('mousemove', (event) => { mouse.x = event.x; mouse.y = event.y; });
            class Particle {
                constructor(x, y, directionX, directionY, size, color) { this.x = x; this.y = y; this.directionX = directionX; this.directionY = directionY; this.size = size; this.color = color; }
                draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = 'rgba(0, 255, 255, 0.5)'; ctx.fill(); }
                update() {
                    if (this.x > canvas.width || this.x < 0) { this.directionX = -this.directionX; }
                    if (this.y > canvas.height || this.y < 0) { this.directionY = -this.directionY; }
                    let dx = mouse.x - this.x; let dy = mouse.y - this.y; let distance = Math.sqrt(dx * dx + dy * dy);
                    if (distance < mouse.radius + this.size) {
                        if (mouse.x < this.x && this.x < canvas.width - this.size * 10) { this.x += 3; }
                        if (mouse.x > this.x && this.x > this.size * 10) { this.x -= 3; }
                        if (mouse.y < this.y && this.y < canvas.height - this.size * 10) { this.y += 3; }
                        if (mouse.y > this.y && this.y > this.size * 10) { this.y -= 3; }
                    }
                    this.x += this.directionX; this.y += this.directionY; this.draw();
                }
            }
            function init() {
                particlesArray = [];
                let numberOfParticles = (canvas.height * canvas.width) / 9000;
                for (let i = 0; i < numberOfParticles; i++) {
                    let size = (Math.random() * 2) + 1;
                    let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2);
                    let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
                    let directionX = (Math.random() * 0.4) - 0.2; let directionY = (Math.random() * 0.4) - 0.2;
                    particlesArray.push(new Particle(x, y, directionX, directionY, size, '#e0e0e0'));
                }
            }
            function connect() {
                let opacityValue = 1;
                for (let a = 0; a < particlesArray.length; a++) {
                    for (let b = a; b < particlesArray.length; b++) {
                        let distance = ((particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x)) + ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
                        if (distance < (canvas.width / 7) * (canvas.height / 7)) {
                            opacityValue = 1 - (distance / 20000);
                            ctx.strokeStyle = `rgba(0, 255, 255, ${opacityValue})`;
                            ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke();
                        }
                    }
                }
            }
            function animate() { requestAnimationFrame(animate); ctx.clearRect(0, 0, innerWidth, innerHeight); for (let i = 0; i < particlesArray.length; i++) { particlesArray[i].update(); } connect(); }
            init(); animate();
            window.addEventListener('resize', () => { canvas.width = innerWidth; canvas.height = innerHeight; mouse.radius = (canvas.height / 120) * (canvas.width / 120); init(); });

            // --- TEXT SCRAMBLE ON SCROLL ---
            class TextScramble {
                constructor(el) { this.el = el; this.chars = '!<>-_\\/[]{}—=+*^?#________'; this.update = this.update.bind(this); }
                setText(newText) {
                    const oldText = this.el.innerText; const length = Math.max(oldText.length, newText.length);
                    const promise = new Promise((resolve) => this.resolve = resolve); this.queue = [];
                    for (let i = 0; i < length; i++) {
                        const from = oldText[i] || ''; const to = newText[i] || ''; const start = Math.floor(Math.random() * 40);
                        const end = start + Math.floor(Math.random() * 40); this.queue.push({ from, to, start, end });
                    }
                    cancelAnimationFrame(this.frameRequest); this.frame = 0; this.update(); return promise;
                }
                update() {
                    let output = ''; let complete = 0;
                    for (let i = 0, n = this.queue.length; i < n; i++) {
                        let { from, to, start, end, char } = this.queue[i];
                        if (this.frame >= end) { complete++; output += to; } 
                        else if (this.frame >= start) {
                            if (!char || Math.random() < 0.28) { char = this.randomChar(); this.queue[i].char = char; }
                            output += `<span class="opacity-50">${char}</span>`;
                        } else { output += from; }
                    }
                    this.el.innerHTML = output;
                    if (complete === this.queue.length) { this.resolve(); } 
                    else { this.frameRequest = requestAnimationFrame(this.update); this.frame++; }
                }
                randomChar() { return this.chars[Math.floor(Math.random() * this.chars.length)]; }
            }
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate');
                        // TRIGGER TEXT SCRAMBLE AND THEN STOP OBSERVING TO PREVENT GLITCH
                        if (entry.target.classList.contains('scramble-text')) {
                            const fx = new TextScramble(entry.target);
                            fx.setText(entry.target.textContent);
                            observer.unobserve(entry.target); // IMPORTANT: Runs once then stops
                        }
                    }
                });
            }, { threshold: 0.2 });
            const scrollElements = document.querySelectorAll('.scroll-animation, .scramble-text');
            scrollElements.forEach(el => observer.observe(el));
        });
    </script>
</body>
</html>
